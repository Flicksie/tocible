(function(a){var f={heading:"h2",subheading:"h3",navigation:"nav",title:"",hash:!1,offset:50,speed:500,collapsible:!1};a.fn.tocible=function(l){var e=a.extend({},f,l);return this.each(function(){var c=a(this),d,g,h,k;d=c.find(e.navigation);k=d.offset().left;d.addClass("tocible").html("<ul/>");c.append(d).css({position:"relative"});if(e.title){var f=a(e.title).length?a(e.title).text():e.title;a("<div/>",{"class":"tocible_header",html:"<span/>"+f}).prependTo(d).click(function(){a(this).siblings("ul").slideToggle({duration:"slow",step:contain});a(this).find("span").toggleClass("toc_open")})}g=c.find(e.heading);h=c.find(e.subheading);g.add(h).each(function(){var b=a(this),d,c,f;d=b.attr("id")?"#"+b.attr("id"):"#";c=b.text();b.is(g)?f="heading":b.is(h)&&(f="subheading");c=a("<a/>",{text:c,href:d});a("<li/>",{"class":"tocible_"+f}).append(c).appendTo(".tocible > ul");c.click(function(c){c.preventDefault();c=b.offset();if(e.hash){var f=a(window).scrollTop();history.pushState?history.pushState({},document.title,d):(window.location.hash=d,a(window).scrollTop(f))}a("html, body").stop(!0).animate({scrollTop:c.top-10},e.speed)})});contain=function(){var b=a(window).scrollTop(),f=c.offset().top;d.css({top:e.offset,bottom:"auto",left:k});f+c.outerHeight()<=b+d.height()+e.offset?d.css({position:"absolute",bottom:0,top:"auto"}):b>=f?d.css({position:"fixed",bottom:"auto",top:e.offset}):d.css({position:"absolute"})};onScroll=function(){e.collapsible&&a(".tocible li.tocible_subheading").hide();g.add(h).each(function(b){var c=a(this).offset().top;b=a(".tocible li").eq(b);a(window).scrollTop()>=c-20?(b.addClass("toc_scrolled").siblings().removeClass("toc_scrolled"),e.collapsible&&(b.siblings().filter(".tocible_subheading").hide(),b.is(".tocible_subheading")?b.prevAll(".tocible_heading:first").nextUntil(".tocible_heading").show():b.is(".tocible_heading")&&b.nextUntil(".tocible_heading").show())):b.removeClass("toc_scrolled")})};a(window).scroll(function(){contain();onScroll()}).trigger("scroll")})}})(jQuery);